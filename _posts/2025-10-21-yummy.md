---
title: "Yummy (Hard)"
date: 2025-10-21
layout: single
excerpt: "Yummy는 Caddy 웹서버가 포트 80에서 동작하는 레스토랑 웹 앱으로 시작하는 Hard 난이도 박스이다. 공격자는 HTTP Location 헤더에서 임의 파일 읽기 취약점을 발견하는데, 이는 기본 Caddy 설정에서 제대로 처리/정규화되지 않는다. 웹 애플리케이션 소스 코드를 살펴보면 JWT에 RSA 키페어를 사용해 관리자 토큰을 위조(forge)하여 권한을 상승시킬 수 있다. 관리자 패널에는 SQL 인젝션이 있어 임의 파일 쓰기가 가능하고, 공격자는 이를 이용해 주기적으로 실행되는 파일(크론잡)을 덮어쓴다. 부적절한 디렉터리 권한 설정으로 공격자는 www-data로 횡적 이동(lateral movement)할 수 있고, 결국 dev 사용자로 권한을 얻는다. dev 사용자는 루트로 실행 가능한 rsync 바이너리를 실행할 수 있어 이를 통해 최종적으로 루트 권한을 획득한다."
author_profile: true
toc: true
toc_label: "Yummy"
toc_icon: "book"
toc_sticky: true
header:
  teaser: /assets/htb-linux/yummy/yummy.png
  teaser_home_page: true
categories: [hackthebox linux]
tags: [htb, yummy, web, jwt, sqli, priv-esc]
---

![Yummy](/assets/htb-linux/yummy/yummy.png)

Yummy는 `Caddy` 웹서버가 포트 80에서 동작하는 레스토랑 웹 앱으로 시작하는 Hard 난이도 박스이다. 

공격자는 `HTTP Location` 헤더에서 **임의 파일 읽기 취약점**을 발견하는데, 이는 기본 `Caddy` 설정에서 제대로 처리/정규화되지 않는다. 

웹 애플리케이션 소스 코드를 살펴보면 `JWT`에 **RSA 키페어**를 사용해 **토큰을 위조(forge)**하여 권한을 상승시킬 수 있다. 관리자 패널에는 **SQL 인젝션**이 있어 **임의 파일 쓰기**가 가능하고, 공격자는 이를 이용해 주기적으로 실행되는 파일(`크론잡`)을 덮어쓴다. 

부적절한 디렉터리 권한 설정으로 공격자는 `www-data`로 **횡적 이동(lateral movement)**할 수 있고, 결국 `dev` 사용자로 권한을 얻는다. `dev` 사용자는 루트로 실행 가능한 `rsync` 바이너리를 실행할 수 있어 이를 통해 최종적으로 `루트` 권한을 획득한다.


# Enumeration

## Portscan

먼저 대상 Host(`10.10.11.36`)에 대해 기본 스크립트와 서비스 버전 탐지를 수행하였다.

```bash
$ nmap -sC -sV 10.10.11.36 | tee nmap
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-21 15:27 EDT
Nmap scan report for yummy.htb (10.10.11.36)
Host is up (0.22s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 9.6p1 Ubuntu 3ubuntu13.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 a2:ed:65:77:e9:c4:2f:13:49:19:b0:b8:09:eb:56:36 (ECDSA)
|_  256 bc:df:25:35:5c:97:24:f2:69:b4:ce:60:17:50:3c:f0 (ED25519)
80/tcp open  http    Caddy httpd
|_http-server-header: Caddy
|_http-title: Yummy
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.85 seconds
```

Nmap 스캔 결과, `SSH(22)`, `HTTP(80)`(Caddy httpd) 서비스가 열려 있고, 웹은 **yummy.htb** 도메인으로 접근해야 함을 확인했다.

## 도메인 이름 설정 (/etc/hosts)

웹 서비스 접근을 위해 `/etc/hosts` 파일에 **10.10.11.36 yummy.htb**를 추가하였다.

```bash
$ cat /etc/hosts | grep htb

10.10.11.36     yummy.htb
```

---

# Vulnerability Analysis