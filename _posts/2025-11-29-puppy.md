---
title: "Puppy (Medium)"
date: 2025-11-24
layout: single
excerpt: "Puppy는 Medium 난이도의 머신이며, 기본이 아닌 DEV라는 SMB 공유가 존재한다. 제공된 levi.james 사용자 자격 증명을 통해 도메인 열거가 가능하다. 열거 결과, 이 사용자가 Developers 그룹에 대해 GenericWrite 권한을 가지고 있음이 드러난다. Levi를 해당 그룹에 추가하면, 이전에는 접근할 수 없던 DEV 공유에 접근이 가능해진다. 이 공유에는 KeePass 데이터베이스의 백업이 존재하며, 이를 다운로드한 뒤 해시를 추출해 크랙할 수 있다. 데이터베이스에는 다양한 사용자 이름과 비밀번호 조합이 포함되어 있다. 패스워드 스프레이 공격을 통해 그중 하나의 비밀번호가 사용자 Ant.Edwards에게 유효함이 확인된다. 또한, 이 새로운 사용자는 Adam.Silver 계정에 대해 GenericAll 권한을 가지고 있어 원하는 비밀번호로 변경할 수 있다. 비밀번호 변경 후, 해당 계정이 비활성화되어 있으므로 다시 활성화해야 한다. 이렇게 하면 WinRM을 통해 원격 시스템 접속이 가능해진다. 이후 웹사이트 백업 파일을 발견함으로써 측면 이동이 이뤄지며, 여기에는 사용자 Steph.cooper의 자격 증명이 포함되어 있다. 마지막으로, Steph의 비밀번호를 사용해 복호화한 DPAPI 자격 증명을 통해 권한 상승이 가능하다. 복호화된 자격 증명은 Steph.cooper_adm이며, 이 계정은 관리자 권한이 있어 최종적으로 시스템의 관리자 권한을 얻을 수 있다."
author_profile: true
toc: true
toc_label: "Puppy"
toc_icon: "book"
toc_sticky: true
header:
  teaser: /assets/htb-windows/puppy/puppy.png
  teaser_home_page: true
categories: [hackthebox-windows]
tags: [windows, active-directory, ldap, smb, winrm, password-spray, priv-esc, shadow-copy, sebackupprivilege, ntds, secretsdump, pass-the-hash, evil-winrm, impacket]
---

![Guardian](/assets/htb-windows/puppy/puppy.png)

Puppy는 **Medium 난이도의 머신**이며, 기본이 아닌 `DEV` 라는 SMB 공유가 존재한다.  
제공된 **`levi.james`** 사용자 자격 증명을 통해 도메인 열거가 가능하다.
열거 결과, 이 사용자가 `Developers` 그룹에 대해 `GenericWrite` 권한을 가지고 있음이 드러난다.

`Levi`를 해당 그룹에 추가하면, 이전에는 접근할 수 없던 `DEV` 공유에 접근이 가능해진다.
이 공유에는 **KeePass 데이터베이스의 백업(`.kdbx`)** 이 존재하며, 이를 다운로드한 뒤 **해시를 추출해 크랙**할 수 있다.  
데이터베이스에는 여러 사용자 계정과 비밀번호 조합이 포함되어 있다.
패스워드 스프레이 공격을 통해 그중 하나의 비밀번호가 사용자 **`Ant.Edwards`** 에게 유효함이 확인된다.

또한 이 새로운 사용자는 **`Adam.Silver` 계정에 대해 GenericAll 권한**을 가지고 있어  
원하는 비밀번호로 변경할 수 있다.  
비밀번호 변경 후, 해당 계정이 **비활성화 상태**이므로 다시 활성화해야 한다.  
이렇게 하면 WinRM을 통해 원격 시스템 접속이 가능해진다.

이후 웹사이트 백업 파일을 발견하게 되며, 여기에는 사용자 `Steph.cooper` 의 자격 증명이 포함되어 있어  
이를 이용해 **측면 이동(Lateral Movement)** 이 가능해진다.

마지막으로, Steph의 비밀번호를 사용해 복호화한 `DPAPI` 자격 증명을 통해  
**권한 상승(Privilege Escalation)** 이 이뤄진다.
복호화된 자격 증명은 `Steph.cooper_adm` 이며, 이 계정은 관리자 권한을 가지고 있어, 최종적으로 시스템의 관리자 권한을 얻을 수 있다.

# Enumeration

## Portscan

먼저 대상 Host(`10.129.232.75`)에 대해 기본 스크립트와 서비스 버전 탐지를 수행하였다:

```bash

```